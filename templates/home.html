{% extends 'base.html' %}

{% block title %}Home{% endblock %}

{% block content %}
{% csrf_token %}

{% if user.is_authenticated %}
Hi {{ user.username }}
<p><a href="{% url 'logout' %}">Log Out</a></p>
{% else %}
    <p>You are not logged in</p>
    <a href="{% url 'login' %}">Log In</a> |
    <a href="{% url 'signup' %}">Sign Up</a>
{% endif %}

<div id="app">
    <h1>[[ message ]]</h1>
    <ul> 
        <li v-for="sneaker in listOfSneakers">
            sneaker-image: <img v-bind:src="sneaker.image.original" alt="" width="400" height="400" 
            v-if="sneaker.image.original"> <br>
            
            name: [[ sneaker.name ]]<br>
            brand: [[ sneaker.brand ]]<br>
            color: [[ sneaker.color ]]<br>
            price: $[[ sneaker.price ]]<br>
            buy: [[ sneaker.links ]]<br>
            <br>
        </li>
    </ul>  


    <ul>
        <li>
            
        </li>
    </ul>
</div>

<script src="https://unpkg.com/vue@2"></script>
<script src="https://cdn.jsdelivr.net/npm/axios@1.1.2/dist/axios.min.js"></script>
<script> 
    const app = new Vue({
        el: '#app',
        delimiters: ['[[', ']]'],
        data: {
            message: "She'Neaker!",
            urlEndpoint: "/api/v1/sneakers/",
            listOfSneakers: '',
            brand: '',
            csrf_token: '',
        },

        methods: {
            getSneakers: function () {
                console.log('loading sneakers')
                axios({
                    method: 'get',
                    url: this.urlEndpoint,
                }).then(response => {
                    console.log(response.data)
                    this.listOfSneakers = response.data
                    console.log('List of Sneakers', this.listOfSneakers)
                }).catch(error => {
                    console.log('error.response: ', error)
                    console.log('error.response.data: ', error.response.data) 
                })

            },

            {% comment %} searchSneakersByBrand: function () {
                axios ({
                    method: 'get',
                    url: `this.urlEndpoint + ${this.brand} `

                }).then(response => {
            } {% endcomment %}
            
          







        },


        mounted: function () {
            console.log('mounting')
            this.csrf_token = document.querySelector("input[name=csrfmiddlewaretoken]").value
            this.getSneakers()

        }



    });
</script> 

{% endblock %}





