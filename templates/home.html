{% extends 'base.html' %}

{% block title %}Home{% endblock %}

{% block content %}
{% csrf_token %}

{% if user.is_authenticated %}
Hi {{ user.username }}
<p><a href="{% url 'logout' %}">Log Out</a></p>
{% else %}
    <p>You are not logged in</p>
    <a href="{% url 'login' %}">Log In</a> |
    <a href="{% url 'signup' %}">Sign Up</a>
{% endif %}

<div id="app">
    <h1>[[ message ]]</h1>
    <ul> 
        <li v-for="sneaker in listOfSneakers">
            image: <img v-bind:src="'https://images.stockx.com/images/Nike-Air-Max-90-Futura-Lunar-New-Year-W.jpg?fit=fill&bg=FFFFFF&w=500&h=500&fm=webp&auto=compress&trim=color&q=90&dpr=2&updated_at=1670428723'" alt="" width="400" height="400"> <br>
            name: [[ sneaker.name ]]<br>
            brand: [[ sneaker.brand ]]<br>
            color: [[ sneaker.color ]]<br>
            price: $[[ sneaker.price ]]<br>
            buy: [[ sneaker.links ]]<br>
            <br>
        </li>
    </ul>  
</div>

<script src="https://unpkg.com/vue@2"></script>
<script src="https://cdn.jsdelivr.net/npm/axios@1.1.2/dist/axios.min.js"></script>
<script> 
    const app = new Vue({
        el: '#app',
        delimiters: ['[[', ']]'],
        data: {
            message: "She'Neaker!",
            urlEndpoint: "/api/v1/sneakers/",
            listOfSneakers: '',
            csrf_token: '',
        },

        methods: {
            getSneakers: function () {
                console.log('loading sneakers')
                axios({
                    method: 'get',
                    url: this.urlEndpoint,
                }).then(response => {
                    console.log(response.data)
                    this.listOfSneakers = response.data
                    console.log('List of Sneakers', this.listOfSneakers)
                }).catch(error => {
                    console.log('error.response: ', error.response)
                    console.log('error.response.data: ', error.response.data)
                })

            },
            
          







        },


        mounted: function () {
            console.log('mounting')
            this.csrf_token = document.querySelector("input[name=csrfmiddlewaretoken]").value
            this.getSneakers()

        }



    });
</script> 

{% endblock %}




{% comment %} getWomenSneakers: function () {
    console.log('getting womens sneakers')
    axios({
        method: 'get',
        url: this.urlEndpoint,
        data: this.listOfSneakers
    }).then(response => {
        console.log(response.data)
        this.listOfSneakers = response.data
        console.log('listOfSneakers', this.listOfSneakers)

    }).catch(error => {
        console.log('error.response:', error.response)
        console.log('error.response.data: ', error.response.data)
    })
}, {% endcomment %}